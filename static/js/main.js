!function(e){function t(t){for(var r,o,s=t[0],i=t[1],l=t[2],d=0,j=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&j.push(c[o][0]),c[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);for(u&&u(t);j.length;)j.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var i=n[s];0!==c[i]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},c={1:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=this["webpackJsonpjira-work-log-extension"]=this["webpackJsonpjira-work-log-extension"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;a.push([27,2]),n()}({23:function(e,t,n){},27:function(e,t,n){e.exports=n(39)},39:function(e,t,n){"use strict";n.r(t);var r,c,a,o=n(2),s=n(18),i=n.n(s),l=n(5),u=n(12),d=n(25),j=n(7),b=n(6),m=n(40),O=n(41),v="TOGGLE_AUTO_COMMENT",f="ADD_NEW_ROW",p="EDIT_ACTION",h="DELETE_ROW",g="FILTER_BY",x="SAVE_DOMAIN",y=Object(O.a)(f),S=Object(O.a)(p),k=Object(O.a)(h),w=Object(O.a)(g),N=Object(O.a)("RESET_STORE"),C=n(26),T={workLogItems:[],filterBy:{}},_=(r={},Object(j.a)(r,y,(function(e){var t,n={id:Object(C.a)(),issue:"",timeSpent:"",logDate:"".concat((new Date).toISOString().split("T")[0]),comment:""},r=(null===(t=e.workLogItems)||void 0===t?void 0:t.slice())||[];return r.push(n),Object(b.a)(Object(b.a)({},e),{},{workLogItems:r})})),Object(j.a)(r,S,(function(e,t){var n=t.payload,r=n.id,c=n.value,a=n.name,o=e.workLogItems.map((function(e){return e.id===r&&("issue"===a?e.issue=c:"timeSpent"===a?e.timeSpent=c:"comment"===a?e.comment=c:"logDate"===a&&(e.logDate=c)),e}));return Object(b.a)(Object(b.a)({},e),{},{workLogItems:o})})),Object(j.a)(r,k,(function(e,t){var n=t.payload.id,r=e.workLogItems.filter((function(e){return e.id!==n}));return Object(b.a)(Object(b.a)({},e),{},{workLogItems:r})})),Object(j.a)(r,w,(function(e,t){var n=t.payload,r=n.value,c=n.name;return Object(b.a)(Object(b.a)({},e),{},{filterBy:{value:r,name:c}})})),Object(j.a)(r,N,(function(){return Object(b.a)({},T)})),r),D=Object(m.a)(_,T),L=Object(O.a)(v),E=Object(j.a)({},L,(function(e){return Object(b.a)(Object(b.a)({},e),{},{autoComment:!e.autoComment})})),I=Object(m.a)(E,{autoComment:!1}),A=Object(O.a)(x),P=Object(O.a)("PUT_ERROR"),R=(c={},Object(j.a)(c,A,(function(e,t){var n=t.payload.domain;return Object(b.a)(Object(b.a)({},e),{},{domain:n})})),Object(j.a)(c,P,(function(e,t){var n=t.payload.error;return Object(b.a)(Object(b.a)({},e),{},{error:n})})),c),M=Object(m.a)(R,{domain:"",error:""}),B=Object(O.a)("SAVE_LOGS"),F=Object(O.a)("SAVE_STATUS"),G=Object(O.a)("UPDATE_SAVED_LOGS"),W=Object(O.a)("RESET_SAVED_LOGS"),V=(a={},Object(j.a)(a,B,(function(e){return Object(b.a)(Object(b.a)({},e),{},{savingInProgress:!0})})),Object(j.a)(a,F,(function(e,t){var n=t.payload.inProgress;return Object(b.a)(Object(b.a)({},e),{},{savingInProgress:n})})),Object(j.a)(a,G,(function(e,t){var n=t.payload.savedLogs;return console.log("updateSavedLogs",n),Object(b.a)(Object(b.a)({},e),{},{savedLogs:n})})),Object(j.a)(a,W,(function(e){return Object(b.a)(Object(b.a)({},e),{},{saveLogs:[]})})),a),U=Object(m.a)(V,{savingInProgress:!1,savedLogs:[]}),q=Object(u.combineReducers)({worklogs:D,autoComment:I,home:M,loggedDetails:U}),H=n(10),J=n.n(H),K=n(9),Y=J.a.mark(X),z=J.a.mark(Z),Q=J.a.mark($);function X(e){var t,n;return J.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(K.d)((function(e){return e.home.domain}));case 2:return t=r.sent,n=e&&Array.isArray(e)&&e.filter((function(e){return e.issue})).map((function(e){var n=e.logDate.split("-"),r='{\n            "timeSpent": "'.concat(e.timeSpent,'",\n            "comment": {\n              "type": "doc",\n              "version": 1,\n              "content": [\n                {\n                  "type": "paragraph",\n                  "content": [\n                    {\n                      "text": "').concat(e.comment,'",\n                      "type": "text"\n                    }\n                  ]\n                }\n              ]\n            },\n            "started":  "').concat(n[0],"-").concat(n[1],"-").concat(n[2],'T18:00:00.751+0000"\n        }');return fetch("https://".concat(t,"/rest/api/3/issue/").concat(e.issue,"/worklog"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:r}).then((function(e){return e.json()})).then((function(t){return{issue:e.issue,data:t}})).catch((function(t){return{issue:e.issue,data:"",error:t}}))})),r.abrupt("return",n);case 5:case"end":return r.stop()}}),Y)}function Z(e){var t,n;return J.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(K.c)(W());case 3:return r.next=5,Object(K.c)(P({error:""}));case 5:return r.next=7,Object(K.b)(X,e.payload);case 7:return t=r.sent,console.log("promises ",t),r.next=11,Promise.allSettled(t).then((function(e){return console.log("Promise results ",e),e})).catch((function(e){return e}));case 11:return n=r.sent,console.log("final data ",n),r.next=15,Object(K.c)(G({savedLogs:n}));case 15:return r.next=17,Object(K.c)(F({inProgress:!1}));case 17:r.next=26;break;case 19:return r.prev=19,r.t0=r.catch(0),r.next=23,Object(K.c)(F({inProgress:!1}));case 23:return r.next=25,Object(K.c)(P({error:"something went wrong, try submiting again with correct data."}));case 25:console.log("erro in saga ",r.t0);case 26:case"end":return r.stop()}}),z,null,[[0,19]])}function $(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(K.a)([Object(K.e)(B,Z)]);case 2:case"end":return e.stop()}}),Q)}var ee=J.a.mark(te);function te(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(K.a)([$()]);case 2:case"end":return e.stop()}}),ee)}var ne=te,re=n(24),ce=Object(d.a)(),ae=[ce],oe=[];ae.length>0&&oe.push(u.applyMiddleware.apply(void 0,ae));var se=Object(u.createStore)(q,re.composeWithDevTools.apply(void 0,oe));ce.run(ne,se.dispatch);var ie=se,le=(n(23),n(1)),ue=function(e){var t=Object(l.b)();return Object(le.jsx)(le.Fragment,{children:Object(le.jsx)("input",{placeholder:e.placeholder,name:e.name,onChange:function(n){t({type:g,payload:{value:n.target.value,name:e.name}})},className:"class_search"})})},de=function(){var e=Object(l.b)();return Object(le.jsxs)("div",{className:"searchOrAdd",children:[Object(le.jsx)(ue,{name:"filterByIssue",placeholder:"Filter by issue/comment"}),Object(le.jsx)("button",{className:"btn-add",onClick:function(){return e({type:f})},children:"Add New"})]})};function je(){var e=Object(l.c)((function(e){return e.autoComment})),t=Object(l.b)();return Object(le.jsxs)("div",{className:"autoCommentContainer",children:[Object(le.jsx)("input",{type:"checkbox",id:"autoComment",value:e,onChange:function(){t({type:v})}}),Object(le.jsx)("label",{htmlFor:"autoComment",children:"Auto Comment"})]})}var be=n(17);var me=function(e){var t,n=Object(o.useState)(0),r=Object(be.a)(n,2),c=r[0],a=r[1],s=Object(o.useState)([]),i=Object(be.a)(s,2),u=i[0],d=i[1],j=Object(o.useState)(!1),b=Object(be.a)(j,2),m=b[0],O=b[1],v=Object(o.useState)(e.value),f=Object(be.a)(v,2),h=f[0],g=f[1],x=Object(l.c)((function(e){var t;return null===(t=e.autoComment)||void 0===t?void 0:t.autoComment})),y=Object(l.c)((function(e){var t;return null===(t=e.home)||void 0===t?void 0:t.domain})),S=Object(l.b)(),k=function(e){console.log("query ",e,y);var t=function(e,t){return{url:"https://".concat(e,"/rest/api/3/issue/picker?query=").concat(t),header:{method:"GET",headers:{Accept:"application/json"}}}}(y,e),n=t.url,r=t.header;e&&fetch(n,r).then((function(e){return e.json()})).then((function(e){var t,n,r;console.log("data ",e,y);var c=(null===e||void 0===e||null===(t=e.sections)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.issues.length)>0?null===(r=e.sections)||void 0===r?void 0:r[0].issues:[];d(c),a(0),O(!0)})).catch((function(e){console.error(e),d([]),O(!1)}))},w=Object(o.useMemo)((function(){return function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var c=arguments.length,a=new Array(c),o=0;o<c;o++)a[o]=arguments[o];t&&clearTimeout(t),t=setTimeout((function(){e.apply(n,a)}),r)}}(k,300)}),[]),N=function(t){x&&S({type:p,payload:{id:e.id,name:"comment",value:"worked on issue "+t}})};return m&&h&&(t=u.length?Object(le.jsx)("ul",{className:"suggestions",children:u.map((function(t,n){var r;return n===c&&(r="suggestion-active"),Object(le.jsxs)("li",{className:r,onClick:function(n){return r=t.key,a(0),d([]),O(!1),g(r),S({type:p,payload:{id:e.id,name:e.name,value:r}}),void N(r);var r},children:[Object(le.jsxs)("div",{className:"img-issue-id",children:[Object(le.jsx)("img",{src:"https://irfangg.atlassian.net".concat(t.img)}),Object(le.jsx)("span",{children:t.key})]}),Object(le.jsx)("div",{children:t.summaryText})]},t.id)}))}):Object(le.jsx)("div",{className:"no-options",children:Object(le.jsx)("em",{children:"No matching issues found !"})})),Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)("input",{type:"text",name:e.name,onChange:function(t){var n=t.currentTarget.value;w(n),g(n),S({type:p,payload:{id:e.id,name:e.name,value:n}}),N(n)},value:h,autoComplete:"off",className:"class_issue",placeholder:"Issue",onKeyDown:function(e){if(13===e.keyCode)a(0),O(!1),console.log("enter ",c,u),g(u[c].key);else if(38===e.keyCode){if(0===c)return;a(c-1)}else if(40===e.keyCode){if(c-1===u.length-2)return;a(c+1),console.log(c)}}}),t]})},Oe=function(){var e=Object(l.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.worklogs)||void 0===t?void 0:t.workLogItems)||[]})),t=Object(l.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.worklogs)||void 0===t?void 0:t.filterBy)||{}})),n=Object(l.b)(),r=function(e,t){n({type:p,payload:{id:t,name:e.target.name,value:e.target.value}})};return Object(le.jsxs)("div",{className:"tableContainer",children:[Object(le.jsxs)("div",{className:"headerRow",children:[Object(le.jsx)("div",{className:"class_issue",children:"Issue"}),Object(le.jsx)("div",{className:"class_timeSpent",children:"Time Spent"}),Object(le.jsx)("div",{className:"class_logDate",children:"Date"}),Object(le.jsx)("div",{className:"class_comments",children:"Comment"})]}),e.length>0&&e.filter((function(e){return""!==t.value&&"filterByIssue"===t.name?e.issue.includes(t.value)||e.comment.includes(t.value):e})).map((function(e){return Object(le.jsxs)("div",{style:{display:"flex"},className:"logRow",children:[Object(le.jsx)(me,{name:"issue",value:e.issue,id:e.id}),Object(le.jsx)("input",{name:"timeSpent",className:"class_timeSpent",placeholder:"1d | 1h | 1m",value:e.timeSpent,onChange:function(t){return r(t,e.id)}}),Object(le.jsx)("input",{name:"logDate",className:"class_logDate",type:"date",value:e.logDate,onChange:function(t){return r(t,e.id)}}),Object(le.jsx)("input",{name:"comment",className:"class_comments",placeholder:"Comment",value:e.comment,onChange:function(t){return r(t,e.id)}}),Object(le.jsx)("button",{className:"del-btn",onClick:function(){return t=e.id,void n({type:h,payload:{id:t}});var t},children:"-"})]},e.id)}))]})};function ve(e){var t=e.className,n=e.clickHandler,r=e.buttonText;return Object(le.jsx)("button",{type:"button",className:t,onClick:n,children:r})}function fe(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.worklogs.workLogItems})),n=Object(l.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.loggedDetails)||void 0===t?void 0:t.savingInProgress)||!1})),r=t.filter((function(e){return e.issue}));return Object(le.jsx)(le.Fragment,{children:n?Object(le.jsx)("div",{className:"saveInProgress",children:"Saving........"}):Object(le.jsx)(ve,{className:"btn btn-save",clickHandler:function(){e(B(r))},buttonText:"Save Work Logs"})})}function pe(){var e=Object(l.c)((function(e){return e.home.error})),t=Object(l.b)();return e&&Object(le.jsxs)("div",{className:"error",children:[Object(le.jsx)("div",{children:Object(le.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),t(P({error:""}))},children:"clear message"})}),Object(le.jsx)("p",{children:e})]})}function he(){var e=Object(l.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.loggedDetails)||void 0===t?void 0:t.savedLogs)||[]})),t=Object(l.b)();return Object(le.jsx)("div",{className:"savedLogs",children:e.length>0?Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)("span",{children:"Saved log details:"}),Object(le.jsx)("ul",{className:"logDetails",children:e.map((function(n,r){var c,a,o,s=n.value,i=s.issue,l=s.data;return Object(le.jsxs)("li",{children:[Object(le.jsxs)("span",{children:[i,":"]}),(null===l||void 0===l?void 0:l.self)&&!(null===l||void 0===l?void 0:l.errorMessages)?Object(le.jsxs)("div",{style:{marginLeft:"1em"},children:[Object(le.jsxs)("span",{children:[" Time Spent : ",Object(le.jsx)("strong",{children:l.timeSpent})]}),Object(le.jsxs)("span",{children:[",  Date : ",Object(le.jsx)("strong",{children:(null===l||void 0===l?void 0:l.started)?null===(c=l.started)||void 0===c||null===(a=c.split("T"))||void 0===a?void 0:a[0]:""})]}),"  ",(null===l||void 0===l?void 0:l.self)&&Object(le.jsx)("button",{className:"logDelBtn",onClick:function(){return n=l.self,c=r,console.log(n,c),void fetch("".concat(n),{method:"DELETE"}).then((function(e){return e.text()})).then((function(n){var r=e.filter((function(e,t){return t!==c}));t(G({savedLogs:r}))})).catch((function(e){return console.error(e)}));var n,c},children:"Delete log"})]}):Object(le.jsxs)("span",{style:{color:"red",marginLeft:"1em"},children:[" ",null===(o=l.errorMessages)||void 0===o?void 0:o.join(",")]})]},r)}))})]}):Object(le.jsx)(pe,{})})}function ge(){return Object(le.jsx)("footer",{children:Object(le.jsx)("span",{children:"- Developed by Irfan G G"})})}var xe=function(){var e=Object(l.b)();return Object(o.useEffect)((function(){chrome.tabs&&chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){var n=t[0].url;console.log(n),e({type:x,payload:{domain:n.split("/")[2]}})}))}),[]),Object(le.jsxs)("div",{className:"App",children:[Object(le.jsx)(de,{}),Object(le.jsx)(je,{}),Object(le.jsx)(Oe,{}),Object(le.jsx)(fe,{}),Object(le.jsx)(he,{}),Object(le.jsx)(ge,{})]})},ye=document.getElementById("root");i.a.render(Object(le.jsx)(l.a,{store:ie,children:Object(le.jsx)(xe,{})}),ye)}});
//# sourceMappingURL=main.js.map